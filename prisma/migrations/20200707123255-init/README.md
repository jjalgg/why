# Migration `20200707123255-init`

This migration has been generated by b6332596 at 7/7/2020, 12:32:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."User" ALTER COLUMN "role" SET DEFAULT E'USER';

CREATE UNIQUE INDEX "AdminComment_authorId" ON "public"."AdminComment"("authorId")

CREATE UNIQUE INDEX "AdminPost_authorId" ON "public"."AdminPost"("authorId")

ALTER TABLE "public"."AdminComment" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."AdminPost" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200706120945-init..20200707123255-init
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model BookMark {
   authorId  String?
@@ -179,26 +179,30 @@
   banning            User[]        @relation("UserBan", references: [id])
   banners            User[]        @relation("UserBan", references: [id])
   following          User[]        @relation("UserFollows", references: [id])
   followers          User[]        @relation("UserFollows", references: [id])
+  adminPost          AdminPost?
+  adminComment       AdminComment?
 }
 model AdminPost {
-  authorId      String?
-  createdAt     DateTime   @default(now())
   id            String     @id @default(cuid())
   text          String
   title         String
-  adminComment  AdminComment[]
+  createdAt     DateTime   @default(now())
+  authorId      String?
+  author        User?      @relation(fields: [authorId], references: [id])
+  comment       AdminComment[]
 }
 model AdminComment {
+  id           String        @id @default(cuid())
+  text         String
+  createdAt    DateTime      @default(now())
   authorId     String?
-  createdAt    DateTime     @default(now())
-  id           String       @id @default(cuid())
-  text         String
-  postId       String? 
-  post         AdminPost?   @relation(fields: [postId], references: [id])
+  author       User?         @relation(fields: [authorId], references: [id])
+  postId       String?
+  post         AdminPost?    @relation(fields: [postId], references: [id])
 }
 enum Role {
   ADMIN
```


